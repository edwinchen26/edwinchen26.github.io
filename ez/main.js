const btn=document.getElementById("generate");function genSalario(e,a,t,n,o,i){let l=0,r=0,d=0;return r=n?o.amount:0,n?a==o.month?(r=o.amount/o.day,o.month=0):r=o.amount:r=0,l=i+r,2==e&&(d=l/=2),{year:t,month:a,amount:parseFloat(l),pending:d}}function getDetails(e,a,t,n){let o={},i=[],l=t.reduce((e,a)=>e+a.amount,0),r=t.reduce((e,a)=>e+a.pending,0),d=t.length<=23?n:0,m=parseFloat((6.54*l/100).toString().match(/^-?\d+(?:\.\d{0,2})?/)[0]);for(let n=e.year;n<=a.year;n++)i.push(t.filter(e=>e.year==n).reduce((e,a)=>e+a.amount,0));let c=parseFloat((i[i.length-1]/11).toString().match(/^-?\d+(?:\.\d{0,2})?/)[0]),u=parseFloat((.01923*(0+c+l)).toString().match(/^-?\d+(?:\.\d{0,2})?/)[0]),s=parseFloat((((t[t.length-1].amount+t[t.length-1].pending)/3+c+0)/12).toString().match(/^-?\d+(?:\.\d{0,2})?/)[0]),g=parseFloat((r+m+d+c+0+s+u).toString().match(/^-?\d+(?:\.\d{0,2})?/)[0]),y=parseFloat((.0975*(r+c+m)).toString().match(/^-?\d+(?:\.\d{0,2})?/)[0]),h=parseFloat((.0725*s).toString().match(/^-?\d+(?:\.\d{0,2})?/)[0]),p=parseFloat((.0125*(r+c+m)).toString().match(/^-?\d+(?:\.\d{0,2})?/)[0]);return o={salary:{name:"Salario por año",value:i},pending:{name:"Salario Pendiente",value:r},indemnizacion:{name:"Indemnización",value:m},preaviso:{name:"Preaviso",value:d},vacacionesVencidas:{name:"Vacaciones Vencidas",value:0},vacacionesProporcionales:{name:"Vacaciones Proporcionales",value:c},primaAntiguedad:{name:"Prima de Antigüedad",value:u},decimo:{name:"Décimo Proporcional",value:s},finalSalary:{name:"Salario Bruto",value:g},seguroSocial:{name:"Seguro Social",value:y},seguroSocialDecimo:{name:"Seguro Social Décimo",value:h},seguroEducativo:{name:"Seguro Educativo",value:p},finalTotal:{name:"Total a Pagar",value:parseFloat((g-(y+h+p)).toString().match(/^-?\d+(?:\.\d{0,2})?/)[0])}}}btn.addEventListener("click",()=>{document.getElementById("salaries").innerHTML="",document.getElementById("details").innerHTML="";let e=[];const a=parseFloat(document.getElementById("amount").value),t={day:parseInt(document.getElementById("startDay").value),month:parseInt(document.getElementById("startMonth").value),year:parseInt(document.getElementById("startYear").value)},n={day:parseInt(document.getElementById("finalDay").value),month:parseInt(document.getElementById("finalMonth").value),year:parseInt(document.getElementById("finalYear").value)};let o={day:parseInt(document.getElementById("incidenciaDay").value),month:parseInt(document.getElementById("incidenciaMonth").value),year:parseInt(document.getElementById("incidenciaYear").value)-t.year,amount:parseFloat(document.getElementById("incidenciaAmount").value),isIncidencia:!1},i=n.year-t.year;if(i<1)for(let i=t.month;i<=n.month;i++){o.isIncidencia=i>=o.month;let l=1;i==t.month?l=t.day:i==n.month&&(l=n.day),e.push(genSalario(l,i,t.year,o.isIncidencia,o,a))}else for(let l=0;l<=i;l++)if(0==l)for(let n=t.month;n<=12;n++){l==o.year&&(o.isIncidencia=n>=o.month);let i=1;n==t.month&&(i=t.day),console.log(i),e.push(genSalario(i,n,l+t.year,o.isIncidencia,o,a))}else if(l==i)for(let i=1;i<=n.month;i++){l==o.year&&(o.isIncidencia=i>=o.month);let r=1;i==n.month&&(r=n.day),e.push(genSalario(r,i,l+t.year,o.isIncidencia,o,a))}else for(let n=1;n<=12;n++)l==o.year&&(o.isIncidencia=n>=o.month),e.push(genSalario(1,n,l+t.year,o.isIncidencia,o,a));const l=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];let r=getDetails(t,n,e,a+o.amount);Object.keys(e).forEach(a=>{let t=document.createElement("li"),n=document.createTextNode(`(${e[a].year}) ${l[e[a].month-1]}: $${e[a].amount}`);t.appendChild(n),document.getElementById("salaries").appendChild(t)}),Object.keys(r).forEach(e=>{let a=document.createElement("li"),t=document.createTextNode(`${r[e].name}: ${r[e].value}`);a.appendChild(t),document.getElementById("details").appendChild(a)})});